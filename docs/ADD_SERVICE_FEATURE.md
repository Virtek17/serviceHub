# Функция добавления услуг

## Реализованные компоненты

### AddServiceModal

**Путь:** `src/components/modals/AddServiceModal.jsx`

Модальное окно для добавления новой услуги с полями:

- Категория (выпадающий список, обязательное)
- Название услуги (обязательное)
- Описание (опциональное)
- Цена в рублях (обязательное)
- Длительность в минутах (обязательное)

**Props:**

- `isOpen` - флаг открытия модалки
- `onClose` - функция закрытия
- `onSave` - функция сохранения с данными формы
- `isLoading` - флаг загрузки при сохранении
- `categories` - массив доступных категорий

**Особенности:**

- Автоматически выбирает первую категорию при открытии
- Блокирует кнопку "Добавить" если нет доступных категорий
- Сбрасывает форму при открытии

## Обновлённые компоненты

### usePerformerServicesFlat Hook

**Путь:** `src/hooks/usePerformerServicesFlat.js`

Добавлено:

1. Состояние `categories` - список категорий мастера
2. Функция `addService` - создаёт новую услугу через API
3. Загрузка категорий при монтировании

**Возвращает:**

```javascript
{
  services, // массив услуг
    categories, // массив категорий
    loading, // флаг загрузки
    error, // ошибка
    editService, // функция редактирования
    addService; // функция добавления
}
```

### ProviderDashboardPage

**Путь:** `src/pages/ProviderDashboardPage.jsx`

Добавлено:

1. Состояние `showAddModal` - флаг открытия модалки добавления
2. Функция `handleAddService` - обрабатывает добавление услуги
3. Компонент `AddServiceModal` в конце JSX
4. Передача `categories` из хука в модалку

## API

### createService

**Путь:** `src/Api/services.js`

```javascript
createService({
  name: string,
  description: string,
  price: number,
  duration: number,
  category_id: number,
});
```

Создаёт новую запись в таблице `services` в Supabase и возвращает:

```javascript
{
  id: number,
  name: string,
  description: string,
  price: number,
  duration: number,
  category: string
}
```

## Как это работает

1. Пользователь нажимает кнопку "Добавить услугу"
2. Открывается модальное окно с пустой формой
3. Автоматически выбирается первая категория из списка
4. Пользователь заполняет поля
5. При нажатии "Добавить":
   - Отправляется запрос в Supabase
   - Новая услуга добавляется в локальное состояние
   - Закрывается модалка
   - Показывается уведомление об успехе
6. Новая услуга сразу появляется в списке

## Валидация

- Категория - обязательное поле (выбор из списка)
- Название услуги - обязательное поле
- Цена - обязательное, только положительные числа
- Длительность - обязательное, только положительные числа
- Описание - опциональное

## Зависимости

Для работы функции необходимо:

1. У мастера должна быть хотя бы одна категория в таблице `service_categories`
2. Если категорий нет - кнопка "Добавить" будет заблокирована
3. В модалке будет показано сообщение "Нет доступных категорий"

## Улучшения для будущего

1. Добавить возможность создания новой категории прямо из модалки
2. Добавить валидацию на стороне клиента (React Hook Form + Zod)
3. Добавить предпросмотр услуги перед сохранением
4. Добавить toast-уведомления вместо alert
5. Добавить возможность загрузки изображения услуги
6. Добавить шаблоны услуг для быстрого добавления
